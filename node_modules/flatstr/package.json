{
  "_args": [
    [
      {
        "raw": "flatstr@^1.0.4",
        "scope": null,
        "escapedName": "flatstr",
        "name": "flatstr",
        "rawSpec": "^1.0.4",
        "spec": ">=1.0.4 <2.0.0",
        "type": "range"
      },
      "/Users/chencc/work/WebstormProjects/node-mqtt/node_modules/pino"
    ]
  ],
  "_from": "flatstr@^1.0.4",
  "_hasShrinkwrap": false,
  "_id": "flatstr@1.0.9",
  "_location": "/flatstr",
  "_nodeVersion": "8.13.0",
  "_npmOperationalInternal": {
    "host": "s3://npm-registry-packages",
    "tmp": "tmp/flatstr_1.0.9_1543942663636_0.26183339731580624"
  },
  "_npmUser": {
    "name": "davidmarkclements",
    "email": "huperekchuno@googlemail.com"
  },
  "_npmVersion": "6.4.1",
  "_phantomChildren": {},
  "_requested": {
    "raw": "flatstr@^1.0.4",
    "scope": null,
    "escapedName": "flatstr",
    "name": "flatstr",
    "rawSpec": "^1.0.4",
    "spec": ">=1.0.4 <2.0.0",
    "type": "range"
  },
  "_requiredBy": [
    "/pino"
  ],
  "_resolved": "https://registry.npmjs.org/flatstr/-/flatstr-1.0.9.tgz",
  "_shasum": "0950d56fec02de1030c1311847ecd58c25690eb9",
  "_shrinkwrap": null,
  "_spec": "flatstr@^1.0.4",
  "_where": "/Users/chencc/work/WebstormProjects/node-mqtt/node_modules/pino",
  "author": {
    "name": "David Mark Clements"
  },
  "browser": {
    "v8": "./v8"
  },
  "bugs": {
    "url": "https://github.com/davidmarkclements/flatstr/issues"
  },
  "dependencies": {},
  "description": "Flattens the underlying C structures of a concatenated JavaScript string",
  "devDependencies": {
    "fastbench": "^1.0.1",
    "tap": "^12.0.1"
  },
  "directories": {},
  "dist": {
    "integrity": "sha512-qFlJnOBWDfIaunF54/lBqNKmXOI0HqNhu+mHkLmbaBXlS71PUd9OjFOdyevHt/aHoHB1+eW7eKHgRKOG5aHSpw==",
    "shasum": "0950d56fec02de1030c1311847ecd58c25690eb9",
    "tarball": "https://registry.npmjs.org/flatstr/-/flatstr-1.0.9.tgz",
    "fileCount": 7,
    "unpackedSize": 12757,
    "npm-signature": "-----BEGIN PGP SIGNATURE-----\r\nVersion: OpenPGP.js v3.0.4\r\nComment: https://openpgpjs.org\r\n\r\nwsFcBAEBCAAQBQJcBrIICRA9TVsSAnZWagAAZ/0P/0jFyqKK3AXSIfEWMa4f\nSFr6QK1H+LQSLz8yNlraJz6vK8Gs2zbqQnKoBF/M0Uekm5tZOXiatU2lEgpG\nLiY5pTJpiOf9dPjpLgb5K/rh67oZlgoZVzVL2PynOZAuCdNd8bWoO4+f65Nj\n4F+zbNcHD2aLGyU3LXoTWB9okjbNeR+HuFTzxbODl38Ca8Oss1gI6I/Vqf/1\nvvm3QbCdkIzmBS4zNOBYqQErsLprTBLA2l/cWjeBNrRy0pwy5xaI9G6jB2s1\nQspS4Yo12EM2tqvuCNHNFAd41ETmWANynvSn8DI8Ei4kUBe2NL7ql9/nolyu\nsMOpbKLZ6mAFWkjiYQ6rFKsO2ttYtd9/qo1jx/v3BZnCnzM6GS4GW0HXzfDh\ncRuiprUZRgs7xwQmj4mUBNnoqM8hbhv1ySB+S/vbJt0fg2V729bpFCU+rrUe\nong824wL6emrYvPBoA+lS+MdmWbypErEJGq4hjb+zsY2YV5Cqx2EMZ0b1pDJ\n3A+1Kzpx7SfuPaUjhFyc3rWHvaE39LxYkBc+eSAuR1UW8CMYZXY0poxURq+1\nh8VK6m1aeT0MiUDvGtBU4Fvp0KjyuGubn5YEoWWE1eSjsYK1IpN+8WXEEuPA\nHB3gcMEuZd9ZPzVRQakemmzqxgqZV5Vh4Fn1iz20iSEKnkEOIqT47NC66Ukj\nav2c\r\n=Kr6v\r\n-----END PGP SIGNATURE-----\r\n"
  },
  "gitHead": "15e6e6de8807f1722be224705d2fd55bb7bb3410",
  "homepage": "https://github.com/davidmarkclements/flatstr#readme",
  "license": "MIT",
  "main": "index.js",
  "maintainers": [
    {
      "name": "davidmarkclements",
      "email": "huperekchuno@googlemail.com"
    }
  ],
  "name": "flatstr",
  "optionalDependencies": {},
  "readme": "# flatstr\n\nFlattens the underlying C structures of a concatenated JavaScript string\n\n## About\n\nIf you're doing lots of string concatenation and then writing that\nstring somewhere, you may find that passing your string through \n`flatstr` vastly improves performance.\n\n## Usage\n\n```js\nvar flatstr = require('flatstr')\nflatstr(someHeavilyConcatenatedString)\n```\n\n## Benchmarks\n\nBenchmarks test flat vs non-flat strings being written to \nan `fs.WriteStream`.\n\n```\nunflattenedManySmallConcats*10000: 147.540ms\nflattenedManySmallConcats*10000: 105.994ms\nunflattenedSeveralLargeConcats*10000: 287.901ms\nflattenedSeveralLargeConcats*10000: 226.121ms\nunflattenedExponentialSmallConcats*10000: 410.533ms\nflattenedExponentialSmallConcats*10000: 219.973ms\nunflattenedExponentialLargeConcats*10000: 2774.230ms\nflattenedExponentialLargeConcats*10000: 1862.815ms\n```\n\nIn each case, flattened strings win, \nhere's the performance gains from using `flatstr`\n\n```\nManySmallConcats: 28%\nSeveralLargeConcats: 21% \nExponentialSmallConcats: 46%\nExponentialLargeConcats: 33%\n```\n\n## How does it work\n\nIn the v8 C++ layer, JavaScript strings can be represented in two ways. \n\n1. As an array\n2. As a tree\n\nWhen JavaScript strings are concatenated, tree structures are used\nto represent them. For the concat operation, this is cheaper than\nreallocating a larger array. However, performing other operations \non the tree structures can become costly (particularly where lots of\nconcatenation has occurred). \n\nV8 has a a method called `String::Flatten`which converts the tree into a C array. This method is typically called before operations that walk through the bytes of the string (for instance, when testing against a regular expression). It may also be called if a string is accessed many times over, \nas an optimization on the string. However, strings aren't always flattened. One example is when we pass a string into a `WriteStream`, at some point the string will be converted to a buffer, and this may be expensive if the underlying representation is a tree. \n\n`String::Flatten` is not exposed as a JavaScript function, but it can be triggered as a side effect. \n\nThere are several ways to indirectly call `String::Flatten` (see `alt-benchmark.js`), \nbut coercion to a number appears to be (one of) the cheapest.\n\nHowever since Node 10 the V8 version has stopped using Flatten in all \nplaces identified. Thus the code has been updated to seamlessly \nuse the native runtime function `%FlattenString` without having to use \nthe `--allow-natives-syntax` flag directly. \n\nOne final note: calling flatstr too much can in fact negatively effect performance. For instance, don't call it every time you concat (if that\nwas performant, v8 wouldn't be using trees in the first place). The best\nplace to use flatstr is just prior to passing it to an API that eventually\nruns non-v8 code (such as `fs.WriteStream`, or perhaps `xhr` or DOM apis in the browser). \n\n\n## Acknowledgements\n\n* Sponsored by nearForm\n\n## License\n\nMIT\n",
  "readmeFilename": "readme.md",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/davidmarkclements/flatstr.git"
  },
  "tags": [
    "perf",
    "performance",
    "strings",
    "concatenation"
  ],
  "version": "1.0.9"
}
